CMAKE_MINIMUM_REQUIRED (VERSION 2.6)

PROJECT (simpleai)

IF (COMMAND cmake_policy)
	cmake_policy (SET CMP0017 NEW)
ENDIF (COMMAND cmake_policy)

INCLUDE_DIRECTORIES (
	${CMAKE_CURRENT_SOURCE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
	${KDOTS_SOURCE_DIR}
)

SET (SIMPLEAI_INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR})

IF (TESTS)
	ENABLE_TESTING ()
ENDIF (TESTS)

SET (SIMPLEAI_HEADERS
	prioritymap.hpp
	rival.hpp
	plugin.hpp
)

SET (SIMPLEAI_SRCS
	prioritymap.cpp
	rival.cpp
	plugin.cpp
)

QT4_WRAP_CPP (SIMPLEAI_HEADERS_MOC ${SIMPLEAI_HEADERS})

ADD_LIBRARY (kdots_simpleai SHARED
	${SIMPLEAI_SRCS}
	${SIMPLEAI_HEADERS_MOC}
)

TARGET_LINK_LIBRARIES (kdots_simpleai
	${QT_LIBRARIES}
)

IF (UNIX)
	INSTALL (TARGETS kdots_simpleai DESTINATION ${PLUGINS_DIR})
ENDIF (UNIX)

IF (UNIX)
	ADD_CUSTOM_COMMAND(
		TARGET kdots_simpleai
		POST_BUILD
		COMMAND cp ARGS ${CMAKE_CURRENT_BINARY_DIR}/libkdots_simpleai.so
		${PLUGIN_BUILD_DIR}
	)
ELSE (UNIX)
	ADD_CUSTOM_COMMAND(
		TARGET kdots_simpleai
		POST_BUILD
		COMMAND copy ARGS ${CMAKE_CURRENT_BINARY_DIR}/libkdots_simpleai.so
		${PLUGIN_BUILD_DIR}
	)
ENDIF (UNIX)

IF (KDE4_BUILD_TESTS)
	ADD_SUBDIRECTORY (tests)
ENDIF (KDE4_BUILD_TESTS)