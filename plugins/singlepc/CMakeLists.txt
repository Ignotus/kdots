CMAKE_MINIMUM_REQUIRED (VERSION 2.6)

PROJECT (singlepc)

IF (COMMAND cmake_policy)
	cmake_policy (SET CMP0017 NEW)
ENDIF (COMMAND cmake_policy)

INCLUDE_DIRECTORIES (
	${CMAKE_CURRENT_SOURCE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
	${KDOTS_SOURCE_DIR}
)

SET (SINGLEPC_HEADERS
	plugin.hpp
)

SET (SINGLEPC_SRCS
	plugin.cpp
)

QT4_WRAP_CPP (SINGLEPC_HEADERS_MOC ${SINGLEPC_HEADERS})

ADD_LIBRARY (kdots_singlepc SHARED
	${SINGLEPC_SRCS}
	${SINGLEPC_HEADERS_MOC}
)

TARGET_LINK_LIBRARIES (kdots_singlepc
	${QT_LIBRARIES}
)

IF (UNIX)
	INSTALL (TARGETS kdots_singlepc DESTINATION ${PLUGINS_DIR})
ENDIF (UNIX)

IF (UNIX)
	ADD_CUSTOM_COMMAND(
		TARGET kdots_singlepc
		POST_BUILD
		COMMAND cp ARGS ${CMAKE_CURRENT_BINARY_DIR}/libkdots_singlepc.so
		${PLUGIN_BUILD_DIR}
	)
ELSE (UNIX)
	ADD_CUSTOM_COMMAND(
		TARGET kdots_singlepc
		POST_BUILD
		COMMAND copy ARGS ${CMAKE_CURRENT_BINARY_DIR}/libkdots_singlepc.so
		${PLUGIN_BUILD_DIR}
	)
ENDIF (UNIX)